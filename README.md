# Электронная таблица
Упрощённый аналог существующих решений: лист таблицы Microsoft Excel или Google Sheets.  
Формулы, как и в существующих решениях, могут содержать индексы ячеек.

- В ячейках таблицы могут быть текст или формулы. Ячейки могут содержать индексы других ячеек;
- Позволяет выполнять простейшие операции ( '+' , '-' , '*' , '/' );
- Для парсинга формул используется ANTRL https://www.antlr.org/ ;
- Поддерживается обработка ошибок в вычислениях и поиск циклических зависимостей в ячейках.

*Для сборки проекта необходима поддержка стандарта не ниже С++17. Сборку производить с помощью CMake.*  
*ANTLR написан на Java, поэтому для его работы вам понадобится комплект разработки JDK https://www.oracle.com/java/technologies/downloads/ .  
Вы также можете использовать OpenJDK. Установите JDK в свою систему.*

## Основные команды

- `set` - задает значение в новой или существующей ячейке.  
Формат ввода `set индекс ячейки "содержимое ячейки"`.  
Пример: `set A5 "=A1+A15"`;
- `print` - выводит на экран содержимое ячейки или содержание всей таблицы. 
Формат ввода `print индекс ячейки`.
Пример: `print A5`;
Для вывода всей таблицы необходимо вместо индекса ячейки ввести дополнительную команду:  
	- `-v` - для вывода значений в ячейках;
	- `-t` - для вывода текста в ячейках;
- `clear` - очищает значение ячейки;
Формат ввода `clear индекс ячейки`.
Пример: `clear A5`;
- `quite` - выход из программы;
- `help` - выводит вышерасположенные команды и их описание.

## Формат ячеек

Для задания формульной ячейки она должна начинаться со знака `=`, все остальные ячейки считаются текстовыми.
Если необходимо начать текстовую ячейку со знака `=`, то необходимо перед ним добавить знак `'`.

Пример:

- `=A1+15` - формульная ячейка;
- `Text` - текстовая ячейка;
- `'=A1+15` - текстовая ячейка.

## Индексы ячеек

Как и в существующих аналогах, индекс ячейки задается строкой вида: `А1`, `С14` или `RD2`.  
Причём ячейка с индексом `А1` — это ячейка в левом верхнем углу таблицы.  
Максимальное количество строк и столбцов в таблице не превышает `16384`.  
Предельная позиция ячейки - `XFD16384`.

## Формат вывода

### Формат вывода ячеек

При использовании команды  `print индекс ячейки` содержимое ячейки выводится в следующем формате:  
- `value: значение в ячейке; text: текст в ячейке` - если ячейка не пустая;
- `empty cell` - если ячейка пуста.

### Формат вывода таблицы

Печатная область таблицы при ее выводе на экран всегда ограничена ячейкой А1 (левым верхним углом таблицы) и крайней ячейкой (ячейками) задающей ее нижний правый угол.
Например, если таблица содержит три ячейки c содержанием: `A1 "15"` , `A3 "=A1-5"`, `D4 "Text"`.
- При использованием команды `print -v` таблица выведется в следующем формате:

```
 |           A|           B|           C|           D|
-|------------|------------|------------|------------|
1|          15|            |            |            |
-|------------|------------|------------|------------|
2|            |            |            |            |
-|------------|------------|------------|------------|
3|          10|            |            |            |
-|------------|------------|------------|------------|
4|            |            |            |        text|
-|------------|------------|------------|------------|
```
- При использовании команды `print -t` таблица выведется в следующем формате:
```
 |           A|           B|           C|           D|
-|------------|------------|------------|------------|
1|          15|            |            |            |
-|------------|------------|------------|------------|
2|            |            |            |            |
-|------------|------------|------------|------------|
3|       =A1-5|            |            |            |
-|------------|------------|------------|------------|
4|            |            |            |        text|
-|------------|------------|------------|------------|
```
Если таблица пуста, то при вызове вышеприведенных команд выведется: `empty sheet`.
При выводе теста в ячейках, если он превышает ее размер, будет выведено только первые
девять символов в тексте и троеточие.  
Например, при введенном тексте: `Hello World!` он будет выведен полностью, а при введенном:
`I love programming` будет выведено только `I love pr...`.  
Для вывода теста целиком необходимо
воспользоваться командой `print индекс ячейки`.

## Обработка ошибок

### Ошибки ввода

- Если при вызове команды был введен некорректный индекс ячейки, то программа выведет: `error: invalid position`;
- Если при вводе значения формульной ячейки была введена синтаксически некорректная формула,
то программа выведет: `error: invalid formula`;
- Если при попытке задать значение ячейки оно приводит к циклической зависимости,
то программа выведет: `error: circular dependency`. Например, если при текущем состоянии таблицы (см. ниже)
попытаться ввести в `А3` формулу `"=C4-1"`, то возникнет циклическая зависимость.
```
 |           A|           B|           C|           D|
-|------------|------------|------------|------------|
1|            |            |            |            |
-|------------|------------|------------|------------|
2|           3|            |      =A3/A2|            |
-|------------|------------|------------|------------|
3|          15|            |            |            |
-|------------|------------|------------|------------|
4|            |            |            |        C2+8|
-|------------|------------|------------|------------|
```

### Ошибки вычисления

- Если при вводе в ячейку формулы, которая не может быть вычислена (например, при делении на `0`), то значение в данной ячейке будет:
`#ARITHM`;
 - Если ячейка ссылается на ячейку, которую нельзя проинтерпретировать как число, то значение в данной ячейке будет:
`#VALUE`;
- Если ячейка ссылается на пустую ячейку или ячейку, которая была очищена, то значение в данной ячейке будет:`#REF`;

Пример, демострирующий ошибки вычисления:

#### Текстовое представление таблицы:
```
 |           A|           B|           C|           D|
-|------------|------------|------------|------------|
1|           3|            |            |            |
-|------------|------------|------------|------------|
2|       =A1/0|            |            |        text|
-|------------|------------|------------|------------|
3|            |       =A3-5|            |            |
-|------------|------------|------------|------------|
4|            |            |            |       =D2/3|
-|------------|------------|------------|------------|
```
#### Значения в таблице:
```
 |           A|           B|           C|           D|
-|------------|------------|------------|------------|
1|           3|            |            |            |
-|------------|------------|------------|------------|
2|    #ARITHM!|            |            |        text|
-|------------|------------|------------|------------|
3|            |       #REF!|            |            |
-|------------|------------|------------|------------|
4|            |            |            |     #VALUE!|
-|------------|------------|------------|------------|
```
